#!/bin/bash
# =============================================================================
# Initialization script for SQLite instance: {{ instance_name }}
# Creates database file and runs bootstrap SQL
# =============================================================================

DB_FILE="/db/{{ instance_name }}.db"
BOOTSTRAP_SQL="/docker-entrypoint-initdb.d/bootstrap.sql"

echo "Initializing SQLite database: $DB_FILE"

# Create database file if it doesn't exist
if [ ! -f "$DB_FILE" ]; then
    echo "Creating new SQLite database file..."
    sqlite3 "$DB_FILE" "SELECT 1;"
    echo "Database file created: $DB_FILE"
fi

# Run bootstrap SQL if it exists
if [ -f "$BOOTSTRAP_SQL" ]; then
    echo "Running bootstrap SQL script..."
    sqlite3 "$DB_FILE" < "$BOOTSTRAP_SQL"
    echo "Bootstrap SQL completed"
else
    echo "No bootstrap SQL found, skipping..."
fi

echo "SQLite initialization completed for instance: {{ instance_name }}"